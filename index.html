<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Trọ</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <main class="card" role="main" aria-labelledby="login-title">
        <div class="brand">
          <div class="logo" aria-hidden="true">ST</div>
          <div>
            <h1 id="login-title">Smart Trọ</h1>
          </div>
        </div>

        <form id="loginForm" novalidate>
          <div class="field">
            <label for="identifier">Email hoặc Số điện thoại</label>
            <input
              id="identifier"
              name="identifier"
              type="text"
              inputmode="email"
              required
              aria-required="true"
            />
            <div
              id="identifierError"
              class="error"
              aria-live="polite"
              style="display: none"
            ></div>
          </div>

          <div class="field password-wrap">
            <label for="password">Mật khẩu</label>
            <input
              id="password"
              name="password"
              type="password"
              required
              aria-required="true"
            />
            <button
              type="button"
              class="toggle-pass"
              id="togglePass"
              aria-label="Hiển thị mật khẩu"
            >
              <!-- eye (visible) -->
              <svg
                class="icon icon-eye"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                width="18"
                height="18"
                aria-hidden="true"
              >
                <path fill="none" d="M0 0h24v24H0z" />
                <path
                  d="M12 5c-7 0-11 6.5-11 7s4 7 11 7 11-6.5 11-7-4-7-11-7zm0 11a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"
                  fill="currentColor"
                />
                <circle cx="12" cy="12" r="2" fill="currentColor" />
              </svg>
              <!-- eye-off (hidden) -->
              <svg
                class="icon icon-eye-off hidden"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                width="18"
                height="18"
                aria-hidden="true"
              >
                <path fill="none" d="M0 0h24v24H0z" />
                <path
                  d="M2 2l20 20-1.4 1.4L17 18.8C15.9 19.3 14.5 19.7 12 19.7c-7 0-11-6.5-11-7 1.1-1.6 3.2-4.1 6.6-5.6L3.4 3.4 2 2zm7.5 7.5l2.1 2.1c-.1.3-.1.6 0 .9a3 3 0 0 0 4.2 0c.1-.3.1-.6 0-.9l3.4 3.4C17.7 16.1 14.9 17.7 12 17.7c-3.5 0-6.1-1.6-8.1-3.6.9-1.3 2.5-3 4.6-4.1l1 1zM12 7.3c1.9 0 3.4.9 4.5 2.2l-1.5 1.5A3 3 0 0 0 12 9.3c-.4 0-.7.1-1 .2L8.9 8.1C10.1 7.4 11 7.3 12 7.3z"
                  fill="currentColor"
                />
              </svg>
            </button>
            <div
              id="passwordError"
              class="error"
              aria-live="polite"
              style="display: none"
            ></div>
          </div>

          <div class="actions">
            <label class="remember"
              ><input id="remember" name="remember" type="checkbox" /> Ghi nhớ
              đăng nhập</label
            >
            <a class="small" href="#">Quên mật khẩu?</a>
          </div>

          <button class="btn" type="submit">Đăng nhập</button>

          <div class="or">
            <hr />
            <span class="hint">hoặc</span>
            <hr />
          </div>

          <div class="links">
            <a class="small" href="#" id="registerLink">Đăng ký tài khoản</a>
            <a class="small" href="#">Xem trang chủ</a>
          </div>
        </form>

        <!-- Registration modal -->
        <div class="modal-overlay hidden" id="registerModal" aria-hidden="true">
          <div
            class="modal"
            role="dialog"
            aria-modal="true"
            aria-labelledby="regTitle"
          >
            <div class="modal-header">
              <h2 id="regTitle">Đăng ký tài khoản</h2>
              <button class="close-btn" id="closeReg" aria-label="Đóng">
                ×
              </button>
            </div>
            <div class="modal-body">
              <form id="registerForm" novalidate>
                <div class="field">
                  <label for="regName">Họ và tên</label>
                  <input
                    id="regName"
                    name="name"
                    type="text"
                    required
                    placeholder="Nguyễn Văn A"
                  />
                  <div
                    class="error"
                    id="regNameError"
                    style="display: none"
                  ></div>
                </div>

                <div class="field">
                  <label for="regEmail">Email</label>
                  <input
                    id="regEmail"
                    name="email"
                    type="email"
                    required
                    placeholder="you@example.com"
                  />
                  <div
                    class="error"
                    id="regEmailError"
                    style="display: none"
                  ></div>
                </div>

                <div class="field">
                  <label for="regPhone">Số điện thoại</label>
                  <input
                    id="regPhone"
                    name="phone"
                    type="text"
                    inputmode="tel"
                    placeholder="0912345678"
                  />
                  <div
                    class="error"
                    id="regPhoneError"
                    style="display: none"
                  ></div>
                </div>

                <div class="field password-wrap">
                  <label for="regPassword">Mật khẩu</label>
                  <input
                    id="regPassword"
                    name="password"
                    type="password"
                    required
                    placeholder="Tối thiểu 6 ký tự"
                  />
                </div>

                <div class="field password-wrap">
                  <label for="regPassword2">Nhập lại mật khẩu</label>
                  <input
                    id="regPassword2"
                    name="password2"
                    type="password"
                    required
                  />
                  <div
                    class="error"
                    id="regPasswordError"
                    style="display: none"
                  ></div>
                </div>

                <div class="actions">
                  <label class="remember"
                    ><input id="regTerms" name="terms" type="checkbox" /> Tôi
                    đồng ý với điều khoản</label
                  >
                </div>

                <div class="modal-footer">
                  <button type="button" class="btn" id="submitReg">
                    Đăng ký
                  </button>
                  <button
                    type="button"
                    class="btn"
                    id="cancelReg"
                    style="background: #f3f4f6; color: #111; margin-left: 8px"
                  >
                    Hủy
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script>
      // Basic client-side validation and UI helpers
      (function () {
        const form = document.getElementById("loginForm");
        const idInput = document.getElementById("identifier");
        const passInput = document.getElementById("password");
        const idErr = document.getElementById("identifierError");
        const passErr = document.getElementById("passwordError");
        const toggle = document.getElementById("togglePass");

        toggle.addEventListener("click", () => {
          const shown = passInput.type === "text";
          passInput.type = shown ? "password" : "text";
          toggle.setAttribute("aria-pressed", String(!shown));
          // swap icons
          const eye = toggle.querySelector(".icon-eye");
          const eyeOff = toggle.querySelector(".icon-eye-off");
          if (eye && eyeOff) {
            if (shown) {
              eye.classList.remove("hidden");
              eyeOff.classList.add("hidden");
              toggle.setAttribute("aria-label", "Hiển thị mật khẩu");
            } else {
              eye.classList.add("hidden");
              eyeOff.classList.remove("hidden");
              toggle.setAttribute("aria-label", "Ẩn mật khẩu");
            }
          }
        });

        function validate() {
          let ok = true;
          idErr.style.display = "none";
          passErr.style.display = "none";

          const idVal = idInput.value.trim();
          if (!idVal) {
            idErr.textContent = "Vui lòng nhập email hoặc số điện thoại.";
            idErr.style.display = "block";
            ok = false;
          }

          const passVal = passInput.value;
          if (!passVal) {
            passErr.textContent = "Vui lòng nhập mật khẩu.";
            passErr.style.display = "block";
            ok = false;
          } else if (passVal.length < 6) {
            passErr.textContent = "Mật khẩu phải có ít nhất 6 ký tự.";
            passErr.style.display = "block";
            ok = false;
          }

          return ok;
        }

        form.addEventListener("submit", function (e) {
          e.preventDefault();
          if (!validate()) return;

          // Demo: hiển thị alert tạm thời. Thay bằng gọi API khi backend có sẵn.
          const data = {
            identifier: idInput.value.trim(),
            password: passInput.value,
            remember: document.getElementById("remember").checked,
          };
          // Replace this with real authentication request
          alert("Đã gửi yêu cầu đăng nhập (demo): " + JSON.stringify(data));
        });

        // --- Registration modal logic ---
        const registerLink = document.getElementById("registerLink");
        const registerModal = document.getElementById("registerModal");
        const closeReg = document.getElementById("closeReg");
        const cancelReg = document.getElementById("cancelReg");
        const submitReg = document.getElementById("submitReg");
        const registerForm = document.getElementById("registerForm");

        function openModal() {
          registerModal.classList.remove("hidden");
          registerModal.setAttribute("aria-hidden", "false");
        }
        function closeModal() {
          registerModal.classList.add("hidden");
          registerModal.setAttribute("aria-hidden", "true");
        }

        registerLink.addEventListener("click", function (e) {
          e.preventDefault();
          openModal();
        });
        closeReg.addEventListener("click", closeModal);
        cancelReg.addEventListener("click", closeModal);
        registerModal.addEventListener("click", function (e) {
          if (e.target === registerModal) closeModal();
        });

        function validateRegister() {
          let ok = true;
          const name = document.getElementById("regName");
          const email = document.getElementById("regEmail");
          const phone = document.getElementById("regPhone");
          const p1 = document.getElementById("regPassword");
          const p2 = document.getElementById("regPassword2");

          // clear errors
          [
            "regNameError",
            "regEmailError",
            "regPhoneError",
            "regPasswordError",
          ].forEach((id) => {
            const el = document.getElementById(id);
            if (el) {
              el.style.display = "none";
              el.textContent = "";
            }
          });

          if (!name.value.trim()) {
            document.getElementById("regNameError").textContent =
              "Vui lòng nhập họ tên.";
            document.getElementById("regNameError").style.display = "block";
            ok = false;
          }
          if (!email.value.trim()) {
            document.getElementById("regEmailError").textContent =
              "Vui lòng nhập email.";
            document.getElementById("regEmailError").style.display = "block";
            ok = false;
          }
          if (p1.value.length < 6) {
            document.getElementById("regPasswordError").textContent =
              "Mật khẩu phải có ít nhất 6 ký tự.";
            document.getElementById("regPasswordError").style.display = "block";
            ok = false;
          }
          if (p1.value !== p2.value) {
            document.getElementById("regPasswordError").textContent =
              "Mật khẩu không khớp.";
            document.getElementById("regPasswordError").style.display = "block";
            ok = false;
          }
          if (!document.getElementById("regTerms").checked) {
            document.getElementById("regPasswordError").textContent =
              "Bạn phải đồng ý với điều khoản.";
            document.getElementById("regPasswordError").style.display = "block";
            ok = false;
          }

          return ok;
        }

        submitReg.addEventListener("click", function () {
          if (!validateRegister()) return;
          const payload = {
            name: document.getElementById("regName").value.trim(),
            email: document.getElementById("regEmail").value.trim(),
            phone: document.getElementById("regPhone").value.trim(),
          };
          alert("Đăng ký demo: " + JSON.stringify(payload));
          closeModal();
        });
      })();
    </script>
  </body>
</html>
